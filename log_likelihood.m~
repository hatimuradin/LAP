function f = log_likelihood (SS, theta, u, v, adj_v, adj_u, Z)
    if nargin < 5     Z = computeZ(theta, u, v, adj_v, adj_u , d);
    end
    f = theta*SS' - n*log(Z);
end